@page "/"
@using HomagGroup.Blazor3D.Geometires.Text;

<div class="row justify-content-center">
    <div class="col-6 v3d">
        <Viewer @ref="View3D1" Scene=scene Camera =" camera"/>
    </div>
</div>

@code {
    private Viewer View3D1 = null!;

    private Camera camera = new PerspectiveCamera(120.0, 0.1, 300.0)
        {
            Position = new Vector3(1, 1, 1),
            AnimateRotationSettings = new AnimateRotationSettings(true, 0.1, 0, 0.1, radius: 3)
            {
                StopAnimationOnOrbitControlMove = true
            },
            LookAt = new Vector3(0.5f, 0, 0)
        };


    private Scene scene = new Scene();

    protected override Task OnInitializedAsync()
    {
        scene.BackGroundColor = "white";
        AddLights();
        FillScene();
        return base.OnInitializedAsync();
    }

    private void AddLights()
    {
        scene.Add(new AmbientLight());
        var plight = new PointLight()
            {
                //Color = "red",
                Decay = 2,
                Position = new Vector3(5, 5, 3)
            };
        scene.Add(plight);
        scene.Add(new PointLightHelper(plight, 0.5));
    }
    private async Task FillScene()
    {
        var text = new Text
            {
                Material = new MeshStandardMaterial
                {
                    Color = "grey",
                },
                Geometry = new TextExtrudeGeometry
                {
                    FontURL = "https://threejs.org/examples/fonts/helvetiker_regular.typeface.json",
                    Size = 1,
                    Height = 0.5,
                    BevelEnabled = true,
                    BevelSegments = 2,
                    BevelSize = 0.05,
                    BevelThickness = 0.1,
                    Text = "Hillyfields",
                },
                Position = new Vector3(0-4, 0 - 0, -1)
            };

        scene.Add(text);
        //await View3D1.SetCameraPositionAsync(
        //new Vector3(0, 0, 0),// camera position
        //new Vector3(0, 0, 0));// optional camera target
        //await View3D1.UpdateScene();
        text = new Text
            {
                Material = new MeshStandardMaterial
                {
                    Color = "grey",
                },
                Geometry = new TextExtrudeGeometry
                {
                    FontURL = "https://threejs.org/examples/fonts/helvetiker_regular.typeface.json",
                    Size = 1,
                    Height = 0.5,
                    BevelEnabled = true,
                    BevelSegments = 2,
                    BevelSize = 0.05,
                    BevelThickness = 0.1,
                    Text = "Bubble",
                },
                Position = new Vector3(0-4, 0 - 1.2, -1)
            };
        scene.Add(text);

        text = new Text
            {
                Material = new MeshStandardMaterial
                {
                    Color = "grey",
                },
                Geometry = new TextExtrudeGeometry
                {
                    FontURL = "https://threejs.org/examples/fonts/helvetiker_regular.typeface.json",
                    Size = 1,
                    Height = 0.5,
                    BevelEnabled = true,
                    BevelSegments = 2,
                    BevelSize = 0.05,
                    BevelThickness = 0.1,
                    Text = "Home",
                },
                Position = new Vector3(0-4, 0 - 2.4, -1)
            };
        scene.Add(text);

        text = new Text
            {
                Material = new MeshStandardMaterial
                {
                    Color = "grey",
                },
                Geometry = new TextExtrudeGeometry
                {
                    FontURL = "https://threejs.org/examples/fonts/helvetiker_regular.typeface.json",
                    Size = 1,
                    Height = 0.5,
                    BevelEnabled = true,
                    BevelSegments = 2,
                    BevelSize = 0.05,
                    BevelThickness = 0.1,
                    Text = "!",
                },
                Position = new Vector3(7-6.5, 0 - 2.4, -1 )
            };
        scene.Add(text);
        //((HomagGroup.Blazor3D.Viewers.Viewer)View3D1).SetCameraPositionAsync(new Vector3(5, 5, 5), new Vector3(0, 0, 0));

    }
}

